# 複雑なデータベース関係研修 - 演習問題集

## 概要

提供されたER図を使用した実践的なデータベース設計研修の演習問題集です。

## 演習1: ER図読解（基礎レベル）

### 問題1-1: エンティティ分析

提供されたER図から以下を答えてください：

1. 最も多くの関係を持つエンティティはどれですか？
2. そのエンティティが持つ関係の数は何個ですか？
3. マスターテーブル（参照テーブル）として機能しているエンティティを5つ挙げてください。

### 問題1-2: リレーションシップの種類

以下の関係について、カーディナリティを答えてください：

1. orders と order_items の関係
2. orders と users の関係
3. order_items と products の関係

## 演習2: 正規化分析（初級レベル）

### 問題2-1: 非正規化の問題特定

ordersテーブルに以下のフィールドが含まれているとします：

- site_id, site_name, site_code
- shop_id, shop_name, shop_code
- payment_method_id, payment_method_name

このような設計の問題点を説明し、正規化による解決策を提案してください。

### 問題2-2: 関数従属性の分析

order_itemsテーブルについて：

1. 主キーは何ですか？
2. 非キー属性の関数従属性を分析してください
3. 第3正規形を満たしているか検証してください

## 演習3: 複雑なリレーションシップ設計（中級レベル）

### 問題3-1: 自己参照関係の設計

prize_exchange_ordersテーブルがordersテーブルに対して2つの関係を持っています：

1. この設計の意図を説明してください
2. このような設計が必要になる業務要件を考えてみてください
3. データ整合性を保つためのチェック制約を提案してください

### 問題3-2: マルチチャネル対応設計

sitesとshopsの関係について：

1. なぜordersテーブルが両方のテーブルを参照しているのか分析してください
2. マルチチャネル販売における在庫管理の課題を考えてください
3. 在庫連携テーブルの設計を提案してください

## 演習4: 特殊サービス統合設計（上級レベル）

### 問題4-1: Hikitakuサービス分析

Hikitaku関連のテーブル群を分析し：

1. Hikitakuサービスの業務フローを推測してください
2. 通常の注文フローとの違いを説明してください
3. サービス拡張時の設計上の考慮点を挙げてください

### 問題4-2: 外部システム連携設計

piapri_ordersテーブルとの連携について：

1. 外部システム連携時のデータ整合性課題を特定してください
2. 連携エラー時の処理方針を設計してください
3. 性能を考慮した連携方式を提案してください

## 演習5: パフォーマンス最適化（上級レベル）

### 問題5-1: インデックス設計

以下のクエリパターンに対する最適なインデックスを設計してください：

1. 特定サイトの注文一覧検索
2. 商品別の売上集計
3. 配送状況による注文検索

### 問題5-2: パーティショニング戦略

ordersテーブルの大量データ対応として：

1. 適切なパーティショニング戦略を提案してください
2. 履歴データの保管方針を考えてください
3. 集計処理の効率化方法を提案してください

## 演習6: 実システム改善提案（実践レベル）

### 問題6-1: システム拡張シナリオ

新しい要件として以下が追加されたとします：

1. 定期購入機能の追加
2. ポイントシステムの導入
3. レビュー・評価機能の追加

各機能に必要なテーブル設計と既存システムとの統合方法を提案してください。

### 問題6-2: データ品質管理

現在のER図に対して：

1. データ品質を保つためのチェック制約を設計してください
2. 業務ルール違反を検出するためのビューを作成してください
3. データクレンジングのためのプロセスを提案してください

## 解答のポイント

### 基礎レベル

- ER図の読み方の理解
- 基本的なリレーションシップの把握
- 正規化の基本概念

### 中級レベル

- 複雑な業務要件の理解
- 設計パターンの適用
- パフォーマンスを意識した設計

### 上級レベル

- システム全体の俯瞰的理解
- 拡張性を考慮した設計
- 実運用を想定した設計判断

## 参考資料

- データベース設計の基本原則
- 正規化理論
- インデックス設計ガイドライン
- パフォーマンスチューニング手法
